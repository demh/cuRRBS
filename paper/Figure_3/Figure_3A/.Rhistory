###########################################################################################
setwd('~/Desktop/methylation_clock/optimize_RRBS/cuRRBS_paper/Figure_3/Figure_3A/');
###########################################################
##################### Dependencies ########################
###########################################################
suppressWarnings(suppressMessages(library(ggplot2)));
################################################################
################## Running the pipeline ########################
################################################################
#### 1. Create a dataframe that contains the CRF for the best enzyme
#    combination in each one of the in silico systems to plot.
file_names <- dir('cuRRBS_outputs/', pattern =".csv");
n <- length(file_names);
cuRRBS_data <- data.frame(System=rep(NA, n), CRF=rep(NA,n));
for(i in 1:n){
file <- file_names[i];
raw_file <- read.csv(paste0('cuRRBS_outputs/',file), header=TRUE);
cuRRBS_data[i,1] <- strsplit(file, '_cuRRBS_output_')[[1]][1];
cuRRBS_data[i,2] <- raw_file[1,7];
}
cuRRBS_data$System <- c('Arabidopsis CHG sites',
'Human epigenetic clock',
'Human CTCF sites',
'Human exon-intron boundaries',
'Human imprinted loci',
'Human placental imprinted loci',
'Mouse iPSCs demethylated',
'Mouse iPSCs maintained',
'Mouse NRF1 sites');
cuRRBS_data_ordered <- cuRRBS_data;
cuRRBS_data_ordered$System <- factor(cuRRBS_data_ordered$System,
levels = cuRRBS_data_ordered$System[order(cuRRBS_data$CRF)]);
# Prepare to add segment legend
cuRRBS_data_ordered$s <-rep('CRF for traditional RRBS', 9);
colnames(cuRRBS_data_ordered) <- c('System', 'CRF', 'CRF for traditional RRBS');
#### 2. Create the barplot ####
CRF_ref <- 30.65; # CRF for the RRBS protocol of reference (RRBS with MspI in human, size selection with beads 20-800 bp)
plot_CRF <- ggplot(cuRRBS_data_ordered, aes(x=System, y=CRF)) +
geom_bar(stat="identity", width=0.5, color="black", fill=c('green', rep('blue',2), 'red', 'blue', rep('red',4))) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.text.x=element_text(angle = 45, hjust = 1),
axis.title=element_text(size=14,face="bold"),
legend.title=element_blank(),
legend.position = c(0.50, 0.9),
legend.text=element_text(size=15),
legend.key.size = unit(4, "cm")) +
xlab('') + ylab('Cost Reduction Factor (CRF)') +
geom_segment(aes(x=1.5, y=CRF_ref, xend=9.5, yend=CRF_ref, linetype=`CRF for traditional RRBS`), col='dimgrey', size=1) +
scale_linetype_manual(values=c("CRF for traditional RRBS"='dotted')) +
guides(linetype = guide_legend(override.aes = list(size = 2)))
#annotate("rect", xmin = 0.5, xmax = 8.5, ymin = 0, ymax = CRF_ref, fill = "grey", alpha=0.5)
plot_CRF
plot_CRF <- ggplot(cuRRBS_data_ordered, aes(x=System, y=CRF)) +
geom_bar(stat="identity", width=0.5, color="black", fill=c('green', rep('blue',2), 'red', 'blue', rep('red',4))) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.text.x=element_text(angle = 45, hjust = 1),
axis.title=element_text(size=14,face="bold"),
legend.title=element_blank(),
legend.position = c(0.50, 0.9),
legend.text=element_text(size=15),
legend.key.size = unit(4, "cm")) +
xlab('') + ylab('Cost Reduction Factor (CRF)') +
#geom_segment(aes(x=1.5, y=CRF_ref, xend=9.5, yend=CRF_ref, linetype=`CRF for traditional RRBS`), col='dimgrey', size=1) +
#scale_linetype_manual(values=c("CRF for traditional RRBS"='dotted')) +
#guides(linetype = guide_legend(override.aes = list(size = 2)))
annotate("rect", xmin = 0.5, xmax = 8.5, ymin = 0, ymax = CRF_ref, fill = "grey", alpha=0.5)
plot_CRF
plot_CRF <- ggplot(cuRRBS_data_ordered, aes(x=System, y=CRF)) +
geom_bar(stat="identity", width=0.5, color="black", fill=c('green', rep('blue',2), 'red', 'blue', rep('red',4))) +
theme_classic() +
theme(axis.text=element_text(size=12),
axis.text.x=element_text(angle = 45, hjust = 1),
axis.title=element_text(size=14,face="bold"),
legend.title=element_blank(),
legend.position = c(0.50, 0.9),
legend.text=element_text(size=15),
legend.key.size = unit(4, "cm")) +
xlab('') + ylab('Cost Reduction Factor (CRF)') +
#geom_segment(aes(x=1.5, y=CRF_ref, xend=9.5, yend=CRF_ref, linetype=`CRF for traditional RRBS`), col='dimgrey', size=1) +
#scale_linetype_manual(values=c("CRF for traditional RRBS"='dotted')) +
#guides(linetype = guide_legend(override.aes = list(size = 2)))
annotate("rect", xmin = 1.5, xmax = 9.5, ymin = 0, ymax = CRF_ref, fill = "grey", alpha=0.5)
plot_CRF
cuRRBS_data_ordered$System
levels(cuRRBS_data_ordered$System)
cat(levels(cuRRBS_data_ordered$System))
source('~/Desktop/methylation_clock/optimize_RRBS/cuRRBS_paper/Figure_3/Figure_3A/create_CRF_plot.R')
source('~/Desktop/methylation_clock/optimize_RRBS/cuRRBS_paper/Figure_3/Figure_3A/create_CRF_plot.R')
source('~/Desktop/methylation_clock/optimize_RRBS/cuRRBS_paper/Figure_3/Figure_3A/create_CRF_plot.R')
